<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Alert - Gone Phishin'</title>
    <link rel="stylesheet" href="interstitial.css">
</head>
<body>
    <div class="interstitial-container">
        <!-- Header Section -->
        <header class="alert-header critical">
            <div class="header-content">
                <div class="alert-icon-large">üö®</div>
                <div class="header-text">
                    <h1>Potential Security Threat Detected</h1>
                    <p class="subtitle">Certificate verification failed - possible MITM attack</p>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="content">
            <!-- Warning Banner -->
            <div class="warning-banner">
                <div class="warning-icon">‚ö†Ô∏è</div>
                <div class="warning-text">
                    <strong>Security Alert:</strong> We've detected unusual certificate behavior that may indicate a man-in-the-middle attack or certificate tampering. Proceeding could expose your sensitive data to attackers.
                </div>
            </div>

            <!-- Site Information -->
            <section class="info-card">
                <h2 class="section-title">
                    <span class="section-icon">üåê</span>
                    Site Information
                </h2>
                <div class="info-grid">
                    <div class="info-row">
                        <span class="info-label">Hostname:</span>
                        <span class="info-value" id="hostname">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Certificate Fingerprint:</span>
                        <span class="info-value code" id="localFingerprint">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Certificate Issuer:</span>
                        <span class="info-value" id="issuer">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">TLS Protocol:</span>
                        <span class="info-value" id="protocol">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Cipher Suite:</span>
                        <span class="info-value code" id="cipher">Loading...</span>
                    </div>
                </div>
            </section>

            <!-- Notary Consensus Results -->
            <section class="info-card" id="notarySection" style="display: none;">
                <h2 class="section-title">
                    <span class="section-icon">üåê</span>
                    Notary Consensus Analysis
                </h2>
                <div class="consensus-summary" id="consensusSummary">
                    <div class="consensus-status" id="consensusStatus">
                        <span class="status-icon">‚è≥</span>
                        <span class="status-text">Analyzing consensus...</span>
                    </div>
                </div>
                <div class="notary-results" id="notaryResults"></div>
                <div class="consensus-explanation" id="consensusExplanation"></div>
            </section>

            <!-- Threat Analysis -->
            <section class="info-card threat-analysis" id="threatAnalysis" style="display: none;">
                <h2 class="section-title">
                    <span class="section-icon">üîç</span>
                    Threat Analysis
                </h2>
                <div class="threat-details" id="threatDetails"></div>
            </section>

            <!-- Educational Section -->
            <section class="info-card educational">
                <h2 class="section-title">
                    <span class="section-icon">üìö</span>
                    What This Means
                </h2>
                <div class="educational-content">
                    <div class="edu-item">
                        <h3>üîê Certificate Mismatch</h3>
                        <p>Our notary servers reported a different certificate fingerprint than what your browser received. This could indicate:</p>
                        <ul>
                            <li>A man-in-the-middle (MITM) attack intercepting your connection</li>
                            <li>Corporate or ISP proxy with certificate inspection</li>
                            <li>Malware on your system intercepting traffic</li>
                            <li>Network misconfiguration</li>
                        </ul>
                    </div>
                    <div class="edu-item">
                        <h3>üõ°Ô∏è How Notary Consensus Works</h3>
                        <p>We query multiple independent notary servers to verify certificates. If they all agree but differ from your local certificate, it indicates a potential attack.</p>
                    </div>
                    <div class="edu-item">
                        <h3>‚ö†Ô∏è What You Should Do</h3>
                        <ul>
                            <li><strong>Do not proceed</strong> if you're on a public or untrusted network</li>
                            <li>Check if you're behind a corporate proxy (ask your IT department)</li>
                            <li>Verify your network connection is secure</li>
                            <li>Consider using a VPN if you must access this site</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Action Buttons -->
            <div class="actions">
                <button class="btn btn-safe" id="goBackBtn">
                    <span class="btn-icon">‚Üê</span>
                    <span>Go Back Safely</span>
                </button>
                <button class="btn btn-warning" id="pinBtn">
                    <span class="btn-icon">üìå</span>
                    <span>Pin for 24h</span>
                </button>
                <button class="btn btn-danger" id="proceedBtn">
                    <span class="btn-icon">‚ö†Ô∏è</span>
                    <span>Proceed Anyway</span>
                </button>
            </div>

            <!-- Footer -->
            <footer class="footer">
                <div class="timestamp" id="timestamp"></div>
                <p class="footer-note">This alert was generated by Gone Phishin' security extension</p>
            </footer>
        </main>
    </div>

    <script src="interstitial.js"></script>
</body>
</html>
