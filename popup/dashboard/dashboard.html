<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gone Phishin' - Security Dashboard</title>
    <link rel="stylesheet" href="dashboard.css">
</head>
<body>
    <!-- Navigation Header -->
    <header class="dashboard-header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo-icon">üõ°Ô∏è</div>
                <div class="logo-text">
                    <h1>Gone Phishin'</h1>
                    <p class="tagline">Security Dashboard</p>
                </div>
            </div>
            <nav class="nav-tabs">
                <button class="nav-tab active" data-tab="overview">Overview</button>
                <button class="nav-tab" data-tab="features">Features</button>
                <button class="nav-tab" data-tab="history">History</button>
                <button class="nav-tab" data-tab="whitelist">Whitelist</button>
                <button class="nav-tab" data-tab="transparency">Transparency</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="dashboard-content">
        <!-- Overview Tab -->
        <section class="tab-content active" id="overviewTab">
            <!-- Quick Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üîí</div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalUpgrades">0</div>
                        <div class="stat-label">HTTPS Upgrades</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üö®</div>
                    <div class="stat-content">
                        <div class="stat-value" id="threatsDetected">0</div>
                        <div class="stat-label">Threats Detected</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üõ°Ô∏è</div>
                    <div class="stat-content">
                        <div class="stat-value" id="sitesProtected">0</div>
                        <div class="stat-label">Sites Analyzed</div>
                    </div>
                </div>
            </div>

            <!-- Protection Status -->
            <section class="dashboard-section">
                <div class="section-header">
                    <h2>üõ°Ô∏è Protection Status</h2>
                </div>
                <div class="protection-grid">
                    <div class="protection-card active">
                        <div class="protection-icon">üîí</div>
                        <div class="protection-info">
                            <h3>HTTPS Enforcement</h3>
                            <p>Automatically upgrades HTTP to HTTPS</p>
                        </div>
                        <div class="protection-badge active">Active</div>
                    </div>
                    <div class="protection-card active">
                        <div class="protection-icon">üîç</div>
                        <div class="protection-info">
                            <h3>Heuristic Analysis</h3>
                            <p>Detecting phishing and suspicious behavior</p>
                        </div>
                        <div class="protection-badge active">Active</div>
                    </div>
                    <div class="protection-card">
                        <div class="protection-icon">üåê</div>
                        <div class="protection-info">
                            <h3>URLScan.io</h3>
                            <p>URL reputation checking</p>
                        </div>
                        <div class="protection-badge" id="urlScanStatusBadge">Checking...</div>
                    </div>
                </div>
            </section>

            <!-- Recent Activity Preview -->
            <section class="dashboard-section">
                <div class="section-header">
                    <h2>üìä Recent Activity</h2>
                    <button class="view-all-btn" id="viewAllHistoryBtn">View All ‚Üí</button>
                </div>
                <div class="activity-preview" id="activityPreview">
                    <!-- Recent activity items will be inserted here -->
                </div>
            </section>
        </section>

        <!-- Features Tab -->
        <section class="tab-content" id="featuresTab">
            <section class="dashboard-section">
                <div class="section-header">
                    <h2>‚ú® Extension Features</h2>
                    <p class="section-description">Learn about all the security features that protect you while browsing</p>
                </div>
                
                <!-- Important Disclaimer -->
                <div class="disclaimer-box">
                    <div class="disclaimer-icon">‚ö†Ô∏è</div>
                    <div class="disclaimer-content">
                        <h3>Important</h3>
                        <p>This extension supplements your browser's built-in security (Safe Browsing, certificate validation). It is not a replacement for:</p>
                        <ul>
                            <li>Chrome's Safe Browsing protection</li>
                            <li>Careful URL inspection</li>
                            <li>Password managers (best phishing defense)</li>
                            <li>Common sense</li>
                        </ul>
                    </div>
                </div>
                
                
                <div class="features-grid">
                    <!-- HTTPS Enforcement -->
                    <div class="feature-card">
                        <div class="feature-header">
                            <div class="feature-icon">üîí</div>
                            <div class="browser-badges">
                                <span class="browser-badge chrome">Chrome</span>
                            </div>
                        </div>
                        <h3>HTTPS Enforcement</h3>
                        <p class="feature-description">Automatically upgrades insecure HTTP connections to secure HTTPS, preventing SSL stripping attacks.</p>
                        <div class="feature-details">
                            <h4>How it works:</h4>
                            <ul>
                                <li>Monitors all navigation requests</li>
                                <li>Detects HTTP connections</li>
                                <li>Automatically redirects to HTTPS</li>
                                <li>Blocks mixed content (HTTP resources on HTTPS pages)</li>
                            </ul>
                            <p class="feature-note"><strong>Note:</strong> Localhost URLs are excluded for development purposes.</p>
                        </div>
                    </div>

                    <!-- Heuristic Analysis -->
                    <div class="feature-card">
                        <div class="feature-header">
                            <div class="feature-icon">üîç</div>
                            <div class="browser-badges">
                                <span class="browser-badge chrome">Chrome</span>
                            </div>
                        </div>
                        <h3>Heuristic Analysis</h3>
                        <p class="feature-description">Pattern-based content analysis that detects phishing attempts and suspicious behavior through pattern recognition.</p>
                        <div class="feature-details">
                            <h4>What it analyzes:</h4>
                            <ul>
                                <li><strong>Form Submissions:</strong> Detects forms submitting to external domains (especially password forms)</li>
                                <li><strong>Link Patterns:</strong> Analyzes external links for suspicious patterns including:
                                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                                        <li>URL shorteners (bit.ly, tinyurl, etc.) - flags chains of multiple shorteners</li>
                                        <li>Typosquatting indicators - lookalike characters, homograph attacks, very short domains</li>
                                        <li>High-risk TLDs (.tk, .ml, .ga, .cf) - known for abuse</li>
                                        <li>Clone patterns - detects when >70% of links point to a single external domain</li>
                                    </ul>
                                </li>
                                <li><strong>Network Requests:</strong> Monitors POST requests to external domains for data exfiltration</li>
                            </ul>
                            <h4>Scoring System:</h4>
                            <ul>
                                <li><strong>CRITICAL (80+):</strong> High-risk threats - Block/Warn</li>
                                <li><strong>WARNING (40-79):</strong> Suspicious patterns - Notify User</li>
                                <li><strong>SECURE (0-39):</strong> No significant threats - Passive Logging</li>
                            </ul>
                            <p class="feature-note"><strong>False Positive Reduction:</strong> Legitimate services (Stripe, PayPal, OAuth providers) are whitelisted.</p>
                        </div>
                    </div>

                    <!-- URLScan.io Integration -->
                    <div class="feature-card">
                        <div class="feature-header">
                            <div class="feature-icon">üåê</div>
                            <div class="browser-badges">
                                <span class="browser-badge chrome">Chrome</span>
                            </div>
                        </div>
                        <h3>URLScan.io Integration</h3>
                        <p class="feature-description">Optional URL reputation checking using URLScan.io API to verify if a URL has been flagged as malicious.</p>
                        <div class="feature-details">
                            <h4>How it works:</h4>
                            <ul>
                                <li>Submits URL to URLScan.io API when you visit a site</li>
                                <li>Polls for scan results (takes ~10-30 seconds)</li>
                                <li>If malicious: Adds +100 to anomaly score</li>
                                <li>If safe: Increases confidence score</li>
                            </ul>
                            <h4>Status:</h4>
                            <ul>
                                <li><strong>Available:</strong> Backend is running, scans are performed</li>
                                <li><strong>Unavailable:</strong> Backend not running - feature should be used when available</li>
                            </ul>
                            <p class="feature-note"><strong>Privacy:</strong> Only the URL is sent to URLScan.io. No personal data is transmitted.</p>
                        </div>
                    </div>

                    <!-- Connection Security -->
                    <div class="feature-card">
                        <div class="feature-header">
                            <div class="feature-icon">üîê</div>
                            <div class="browser-badges">
                                <span class="browser-badge firefox">Firefox</span>
                            </div>
                        </div>
                        <h3>Connection Security Check</h3>
                        <p class="feature-description">Verifies that sites use HTTPS with valid certificates validated by your browser.</p>
                        <div class="feature-details">
                            <h4>What it checks:</h4>
                            <ul>
                                <li>HTTPS protocol usage</li>
                                <li>Browser certificate validation</li>
                                <li>Certificate expiration</li>
                                <li>Certificate authority trust</li>
                            </ul>
                            <p class="feature-note"><strong>Chrome MV3 Limitation:</strong> Advanced certificate monitoring (fingerprint tracking, issuer drift) requires Firefox MV2 version.</p>
                        </div>
                    </div>

                    <!-- Real-time Monitoring -->
                    <div class="feature-card">
                        <div class="feature-header">
                            <div class="feature-icon">‚ö°</div>
                            <div class="browser-badges">
                                <span class="browser-badge chrome">Chrome</span>
                            </div>
                        </div>
                        <h3>Real-time Monitoring</h3>
                        <p class="feature-description">Continuously monitors the active tab for security threats and updates the anomaly score in real-time.</p>
                        <div class="feature-details">
                            <h4>Features:</h4>
                            <ul>
                                <li>Focuses only on the active tab (better performance)</li>
                                <li>Analyzes pages on initial load</li>
                                <li>Updates popup in real-time</li>
                                <li>Shows threat count and severity</li>
                            </ul>
                            <p class="feature-note">The extension analyzes pages as you browse and updates the popup automatically.</p>
                        </div>
                    </div>

                    <!-- Whitelist Management -->
                    <div class="feature-card">
                        <div class="feature-header">
                            <div class="feature-icon">‚úÖ</div>
                            <div class="browser-badges">
                                <span class="browser-badge chrome">Chrome</span>
                            </div>
                        </div>
                        <h3>Whitelist Management</h3>
                        <p class="feature-description">Manage trusted sites that should bypass security checks to reduce false positives.</p>
                        <div class="feature-details">
                            <h4>Use cases:</h4>
                            <ul>
                                <li>Trusted sites that trigger false positives</li>
                                <li>Internal company websites</li>
                                <li>Development/testing environments</li>
                            </ul>
                            <p class="feature-note">Whitelisted sites will bypass security checks. Use with caution.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Scoring System Explanation -->
            <section class="dashboard-section">
                <div class="section-header">
                    <h2>üìê Computing the Anomaly Score and Confidence Score</h2>
                </div>
                
                <div class="scoring-explanation-content">
                    <div class="scoring-intro">
                        <p>The extension uses a unified mathematical scoring system that combines all security features into normalized threat and confidence scores. This ensures consistent, mathematically sound threat assessment.</p>
                    </div>

                    <div class="scoring-formula-card">
                        <h3>üìä Final Threat Score Formula</h3>
                        <div class="formula-box">
                            <code>Final Threat Score = min(100, Œ£(weight_i √ó normalized_score_i))</code>
                        </div>
                        <p class="formula-explanation">
                            The final threat score is calculated by:
                        </p>
                        <ol>
                            <li>Normalizing each feature's raw score to 0-100 range using min-max normalization</li>
                            <li>Multiplying each normalized score by its feature weight</li>
                            <li>Summing all weighted scores</li>
                            <li>Clamping the result to [0, 100]</li>
                        </ol>
                    </div>

                    <div class="scoring-formula-card">
                        <h3>üéØ Final Confidence Score Formula</h3>
                        <div class="formula-box">
                            <code>Final Confidence Score = Œ£(weight_i √ó confidence_i)</code>
                        </div>
                        <p class="formula-explanation">
                            The confidence score represents how certain we are about the threat assessment:
                        </p>
                        <ol>
                            <li>Each feature contributes a confidence value (0-100)</li>
                            <li>Confidences are weighted by their feature weights</li>
                            <li>Weighted confidences are summed and normalized</li>
                            <li>Result is clamped to [0, 100]</li>
                        </ol>
                    </div>

                    <div class="feature-weights-card">
                        <h3>‚öñÔ∏è Feature Weights</h3>
                        <p>Each security feature is assigned a weight based on its importance and reliability:</p>
                        <div class="weights-grid">
                            <div class="weight-item">
                                <div class="weight-feature">URLScan.io</div>
                                <div class="weight-value">60%</div>
                                <div class="weight-description">Most reliable signal when available - external threat intelligence</div>
                            </div>
                            <div class="weight-item">
                                <div class="weight-feature">Heuristics Analysis</div>
                                <div class="weight-value">25%</div>
                                <div class="weight-description">Pattern-based analysis - always available, detects behavioral patterns</div>
                            </div>
                            <div class="weight-item">
                                <div class="weight-feature">HTTPS Enforcement</div>
                                <div class="weight-value">15%</div>
                                <div class="weight-description">Important but binary - either upgraded or not</div>
                            </div>
                            <div class="weight-item">
                                <div class="weight-feature">Connection Security</div>
                                <div class="weight-value">0%</div>
                                <div class="weight-description">Not used in scoring - handled by browser's built-in security</div>
                            </div>
                        </div>
                        <p class="weight-note"><strong>Note:</strong> Weights sum to 100%. If URLScan.io is unavailable, its weight is redistributed proportionally to other features.</p>
                    </div>

                    <div class="normalization-card">
                        <h3>üìè Score Normalization</h3>
                        <p>Each feature's raw score is normalized to a 0-100 scale using min-max normalization:</p>
                        <div class="formula-box">
                            <code>normalized_score = (raw_score / max_possible_score) √ó 100</code>
                        </div>
                        <div class="max-scores-table">
                            <h4>Maximum Possible Scores:</h4>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Feature</th>
                                        <th>Max Raw Score</th>
                                        <th>Normalized Max</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Heuristics Analysis</td>
                                        <td>200</td>
                                        <td>100</td>
                                    </tr>
                                    <tr>
                                        <td>URLScan.io</td>
                                        <td>100</td>
                                        <td>100</td>
                                    </tr>
                                    <tr>
                                        <td>HTTPS Enforcement</td>
                                        <td>20</td>
                                        <td>100</td>
                                    </tr>
                                    <tr>
                                        <td>Connection Security</td>
                                        <td>10</td>
                                        <td>100</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="severity-card">
                        <h3>üö® Severity Determination</h3>
                        <p>Severity is determined using a confidence-adjusted score:</p>
                        <div class="formula-box">
                            <code>adjusted_score = threat_score √ó (confidence_score / 100)</code>
                        </div>
                        <div class="severity-thresholds">
                            <div class="threshold-item critical">
                                <strong>CRITICAL:</strong> adjusted_score ‚â• 80 OR (threat_score ‚â• 90 AND confidence_score ‚â• 60)
                            </div>
                            <div class="threshold-item warning">
                                <strong>WARNING:</strong> adjusted_score ‚â• 40 OR (threat_score ‚â• 50 AND confidence_score ‚â• 40)
                            </div>
                            <div class="threshold-item secure">
                                <strong>SECURE:</strong> All other cases
                            </div>
                        </div>
                    </div>

                    <div class="example-card">
                        <h3>üí° Example Calculation</h3>
                        <p>Let's say a website has:</p>
                        <ul>
                            <li>URLScan: malicious (normalized: 100), confidence = 100%</li>
                            <li>Heuristics: raw score = 150 (normalized: 75), confidence = 80%</li>
                            <li>HTTPS: upgraded (normalized: 0), confidence = 100%</li>
                        </ul>
                        <div class="calculation-steps">
                            <div class="step">
                                <strong>Step 1:</strong> Calculate weighted threat score
                                <code>0.60√ó100 + 0.25√ó75 + 0.15√ó0 = 60 + 18.75 + 0 = 78.75</code>
                            </div>
                            <div class="step">
                                <strong>Step 2:</strong> Calculate weighted confidence
                                <code>0.60√ó100 + 0.25√ó80 + 0.15√ó100 = 60 + 20 + 15 = 95</code>
                            </div>
                            <div class="step">
                                <strong>Step 3:</strong> Calculate adjusted score
                                <code>78.75 √ó (95/100) = 78.75 √ó 0.95 = 74.81</code>
                            </div>
                            <div class="step">
                                <strong>Result:</strong> <strong class="warning-result">WARNING</strong> (adjusted_score = 74.81, threat_score = 78.75 ‚â• 50)
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </section>

        <!-- History Tab -->
        <section class="tab-content" id="historyTab">
            <section class="dashboard-section">
                <div class="section-header">
                    <h2>üìä Website History</h2>
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="critical">Critical</button>
                        <button class="filter-btn" data-filter="warning">Warnings</button>
                        <button class="filter-btn" data-filter="secure">Secure</button>
                    </div>
                </div>
                
                <div class="history-list" id="historyList">
                    <!-- History items will be inserted here -->
                </div>
            </section>
        </section>

        <!-- Whitelist Tab -->
        <section class="tab-content" id="whitelistTab">
            <section class="dashboard-section">
                <div class="section-header">
                    <h2>üõ°Ô∏è Whitelisted URLs</h2>
                    <button class="btn btn-secondary" id="refreshWhitelistBtn">
                        <span class="btn-icon">üîÑ</span>
                        <span>Refresh</span>
                    </button>
                </div>

                <div class="whitelist-info">
                    <p class="whitelist-description">
                        Sites in your whitelist will bypass security checks. Use this for trusted sites that may trigger false positives.
                    </p>
                </div>

                <div class="whitelist-container" id="whitelistContainer">
                    <div class="whitelist-loading">Loading whitelist...</div>
                </div>
            </section>
        </section>

        <!-- Transparency Tab -->
        <section class="tab-content" id="transparencyTab">
            <section class="dashboard-section">
                <div class="section-header">
                    <h2>üîç Extension Transparency</h2>
                </div>
                
                <div class="transparency-content">
                    <div class="transparency-section">
                        <h3>üìã Permissions & Access</h3>
                        <div class="permission-item">
                            <div class="permission-icon">üåê</div>
                            <div class="permission-info">
                                <h4>Host Permissions (<code>&lt;all_urls&gt;</code>)</h4>
                                <p><strong>Why:</strong> To analyze websites you visit and enforce HTTPS upgrades</p>
                                <p><strong>What it does:</strong> Allows the extension to read page content and network requests for security analysis</p>
                                <p><strong>Data:</strong> Analysis results are stored locally in your browser. No data is sent to external servers except URLScan.io API calls (with your consent).</p>
                            </div>
                        </div>

                        <div class="permission-item">
                            <div class="permission-icon">üíæ</div>
                            <div class="permission-info">
                                <h4>Storage Permission</h4>
                                <p><strong>Why:</strong> To store analysis results, whitelist, and statistics locally</p>
                                <p><strong>What it stores:</strong> Heuristic analysis results, HTTPS upgrade counts, whitelisted URLs, threat history</p>
                                <p><strong>Location:</strong> All data is stored locally using Chrome's <code>chrome.storage.local</code> API. No cloud storage.</p>
                            </div>
                        </div>

                        <div class="permission-item">
                            <div class="permission-icon">üîí</div>
                            <div class="permission-info">
                                <h4>Declarative Net Request</h4>
                                <p><strong>Why:</strong> To automatically upgrade HTTP to HTTPS connections</p>
                                <p><strong>What it does:</strong> Intercepts HTTP requests and redirects them to HTTPS when available</p>
                                <p><strong>Privacy:</strong> This happens locally in your browser. No external requests are made for this feature.</p>
                            </div>
                        </div>

                        <div class="permission-item">
                            <div class="permission-icon">üì°</div>
                            <div class="permission-info">
                                <h4>Web Request & Navigation APIs</h4>
                                <p><strong>Why:</strong> To monitor network activity and detect threats</p>
                                <p><strong>What it monitors:</strong> Page navigations, network requests (for heuristic analysis)</p>
                                <p><strong>Privacy:</strong> All analysis happens locally. Only URLScan.io API calls (optional) send URLs externally.</p>
                            </div>
                        </div>
                    </div>

                    <div class="transparency-section">
                        <h3>üîê Data Privacy</h3>
                        <div class="privacy-item">
                            <h4>What Data is Collected?</h4>
                            <ul>
                                <li><strong>Website Analysis:</strong> Heuristic analysis results (anomaly scores, detected threats) - stored locally</li>
                                <li><strong>HTTPS Upgrades:</strong> Count of upgrades performed - stored locally</li>
                                <li><strong>Whitelist:</strong> URLs you manually whitelist - stored locally</li>
                                <li><strong>No Personal Data:</strong> The extension does not collect passwords, personal information, or browsing history</li>
                            </ul>
                        </div>

                        <div class="privacy-item">
                            <h4>Where is Data Stored?</h4>
                            <ul>
                                <li><strong>Local Storage:</strong> All data is stored in your browser's local storage</li>
                                <li><strong>No Cloud Sync:</strong> Data is not synced to cloud services</li>
                                <li><strong>No External Servers:</strong> Except optional URLScan.io API calls (which you can see in the code)</li>
                            </ul>
                        </div>

                        <div class="privacy-item">
                            <h4>External Services</h4>
                            <ul>
                                <li><strong>URLScan.io:</strong> Optional API integration for URL reputation checking. Only called when you visit a site, and only sends the URL.</li>
                                <li><strong>No Tracking:</strong> The extension does not use analytics, tracking pixels, or telemetry</li>
                            </ul>
                        </div>
                    </div>

                    <div class="transparency-section">
                        <h3>üìñ Open Source</h3>
                        <div class="opensource-item">
                            <p>This extension is open source. You can review all code to verify:</p>
                            <ul>
                                <li>What permissions are used and why</li>
                                <li>What data is collected and where it's stored</li>
                                <li>What external services are called</li>
                                <li>How the heuristic analysis works</li>
                            </ul>
                            <p class="feature-note"><strong>Academic Project:</strong> This extension was developed as an academic capstone project. All code is available for review.</p>
                        </div>
                    </div>
                </div>
            </section>
        </section>
    </main>

    <script src="dashboard.js"></script>
</body>
</html>
